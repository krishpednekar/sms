{% extends "base.html" %}

{% block title %}Attendance Reports{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Attendance Reports</h2>
    <a href="{{ url_for('view_reports') }}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Back to Reports
    </a>
</div>

{% for student_data in attendance_data %}
<div class="card mb-4">
    <div class="card-header">
        <h5>{{ student_data.student.first_name }} {{ student_data.student.last_name }}</h5>
    </div>
    <div class="card-body">
        {% if student_data.subjects %}
        <table class="table">
            <thead>
                <tr>
                    <th>Subject</th>
                    <th>Attendance Percentage</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in student_data.subjects %}
                <tr>
                    <td>{{ subject.name }}</td>
                    <td>
                        <div class="progress-bar" 
     style="--progress-width: {{ stat.percentage|round(1) }}%; 
            width: calc(var(--progress-width) + 0.1%); 
            min-width: 2em;">
    {{ "%.1f"|format(stat.percentage) }}%
</div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="alert alert-info">No attendance records found for this student.</div>
        {% endif %}
    </div>
</div>
{% endfor %}
{% endblock %}